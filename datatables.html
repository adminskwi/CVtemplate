<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataTables</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/2.1.5/css/dataTables.bootstrap5.css">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
</head>
<body>

<div class="container mt-5">
    <h2 class="mb-4">DataTables</h2>

    <!-- Nav tabs -->
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <a class="nav-link active" id="tab1-tab" data-bs-toggle="tab" href="#tab1" role="tab" aria-controls="tab1" aria-selected="true">Tab 1</a>
        </li>
        <li class="nav-item" role="presentation">
            <a class="nav-link" id="tab2-tab" data-bs-toggle="tab" href="#tab2" role="tab" aria-controls="tab2" aria-selected="false">Tab 2</a>
        </li>
    </ul>

    <!-- Tab content -->
    <div class="tab-content mt-3" id="myTabContent">
        <div class="tab-pane fade show active" id="tab1" role="tabpanel" aria-labelledby="tab1-tab">
            <button id="deleteSelected1" class="btn btn-danger mb-3">Delete Selected Rows</button>
            <div class="top-pagination"></div>
            <!-- Column toggle buttons for Tab 1 -->
            <div class="column-toggle-buttons">
                <button class="btn btn-primary" data-column="1">Show/Hide Name</button>
                <button class="btn btn-primary" data-column="2">Show/Hide Position</button>
                <button class="btn btn-primary" data-column="3">Show/Hide Office</button>
                <button class="btn btn-primary" data-column="4">Show/Hide Age</button>
                <button class="btn btn-primary" data-column="5">Show/Hide Start Date</button>
                <button class="btn btn-primary" data-column="6">Show/Hide Salary</button>
                <button class="btn btn-primary" data-column="6">Show/Hide Department</button>
            </div>
            <table id="example1" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th><input type="checkbox" id="selectAll1"></th>
                        <th>Name</th>
                        <th>Position</th>
                        <th>Office</th>
                        <th>Age</th>
                        <th>Start Date</th>
                        <th>Salary</th>
                        <th>Department</th>
                    </tr>
                    <tr>
                        <th></th> <!-- Empty cell for the select all checkbox -->
                        <th><input type="text" placeholder="Search Name"></th>
                        <th><input type="text" placeholder="Search Position"></th>
                        <th><input type="text" placeholder="Search Office"></th>
                        <th><input type="text" placeholder="Search Age"></th>
                        <th><input type="text" placeholder="Search Start Date"></th>
                        <th><input type="text" placeholder="Search Salary"></th>
                        <th><input type="text" placeholder="Search Department"></th>
                    </tr>
                </thead>
            </table>
        </div>
        <div class="tab-pane fade" id="tab2" role="tabpanel" aria-labelledby="tab2-tab">
            <button id="deleteSelected2" class="btn btn-danger mb-3">Delete Selected Rows</button>
            <div class="top-pagination"></div>
            <!-- Column toggle buttons for Tab 2 -->
            <div class="column-toggle-buttons">
                <button class="btn btn-primary" data-column="1">Show/Hide Name</button>
                <button class="btn btn-primary" data-column="2">Show/Hide Position</button>
                <button class="btn btn-primary" data-column="3">Show/Hide Office</button>
                <button class="btn btn-primary" data-column="4">Show/Hide Age</button>
                <button class="btn btn-primary" data-column="5">Show/Hide Start Date</button>
                <button class="btn btn-primary" data-column="6">Show/Hide Salary</button>
                <button class="btn btn-primary" data-column="6">Show/Hide Department</button>
            </div>
            <table id="example2" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th><input type="checkbox" id="selectAll2"></th>
                        <th>Name</th>
                        <th>Position</th>
                        <th>Office</th>
                        <th>Age</th>
                        <th>Start Date</th>
                        <th>Salary</th>
                        <th>Department</th>
                    </tr>
                    <tr>
                        <th></th> <!-- Empty cell for the select all checkbox -->
                        <th><input type="text" placeholder="Search Name"></th>
                        <th><input type="text" placeholder="Search Position"></th>
                        <th><input type="text" placeholder="Search Office"></th>
                        <th><input type="text" placeholder="Search Age"></th>
                        <th><input type="text" placeholder="Search Start Date"></th>
                        <th><input type="text" placeholder="Search Salary"></th>
                        <th><input type="text" placeholder="Search Department"></th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
</div>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
<!-- DataTables JS -->
<script src="https://cdn.datatables.net/2.1.5/js/dataTables.js"></script>
<script src="https://cdn.datatables.net/2.1.5/js/dataTables.bootstrap5.js"></script>
<!-- Bootstrap 5 JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

<script>
    $(document).ready(function () {
        // Initialize DataTables for both tabs
        var table1 = $('#example1').DataTable({
            "ajax": {
                "url": "data.json", // Ensure the path is correct
                "dataSrc": ""
            },
            "columns": [
                {
                    "data": null,
                    "defaultContent": '<input type="checkbox" class="row-select">',
                    "orderable": false,
                    "searchable": false
                },
                { "data": "name" },
                { "data": "position" },
                { "data": "office" },
                { "data": "age" },
                { "data": "start_date" },
                { "data": "salary" },
                { "data": "department" }
            ],
            "dom": '<"top-pagination"p>rt<"bottom"li><"clear">',
            "pagingType": "simple_numbers",
            "language": {
                "lengthMenu": "Show _MENU_ entries",
                "info": "Showing _START_ to _END_ of _TOTAL_ entries"
            },
            "order": [], // Disable initial column sorting
            "columnDefs": [
                {
                    "targets": "_all",
                    "orderable": false // Disable sorting on all columns
                }
            ],
            initComplete: function () {
                // Apply the search
                this.api().columns().every(function () {
                    var that = this;

                    $('input', this.header()).on('keyup change clear', function () {
                        // Only perform search and redraw if value has changed
                        if (that.search() !== this.value) {
                            that.search(this.value).draw(false); // Set second argument to false to avoid sorting
                        }
                    });
                });
            }
        });

        var table2 = $('#example2').DataTable({
            "ajax": {
                "url": "data.json", // Ensure the path is correct
                "dataSrc": ""
            },
            "columns": [
                {
                    "data": null,
                    "defaultContent": '<input type="checkbox" class="row-select">',
                    "orderable": false,
                    "searchable": false
                },
                { "data": "name" },
                { "data": "position" },
                { "data": "office" },
                { "data": "age" },
                { "data": "start_date" },
                { "data": "salary" },
                { "data": "department" }
            ],
            "dom": '<"top-pagination"p>rt<"bottom"li><"clear">',
            "pagingType": "simple_numbers",
            "language": {
                "lengthMenu": "Show _MENU_ entries",
                "info": "Showing _START_ to _END_ of _TOTAL_ entries"
            },
            "order": [], // Disable initial column sorting
            "columnDefs": [
                {
                    "targets": "_all",
                    "orderable": false // Disable sorting on all columns
                }
            ],
            initComplete: function () {
                // Apply the search
                this.api().columns().every(function () {
                    var that = this;

                    $('input', this.header()).on('keyup change clear', function () {
                        // Only perform search and redraw if value has changed
                        if (that.search() !== this.value) {
                            that.search(this.value).draw(false); // Set second argument to false to avoid sorting
                        }
                    });
                });
            }
        });

        // Select all rows in Tab 1
        $('#selectAll1').on('click', function () {
            var isChecked = $(this).is(':checked');
            $('#example1 .row-select').prop('checked', isChecked);
        });

        // Delete selected rows in Tab 1
        $('#deleteSelected1').on('click', function () {
            var rowsToDelete = [];
            table1.rows().every(function () {
                var $checkbox = $(this.node()).find('.row-select');
                if ($checkbox.is(':checked')) {
                    rowsToDelete.push(this); // Collect rows to delete
                }
            });

            // Remove selected rows
            rowsToDelete.forEach(function (row) {
                row.remove().draw();
            });

            // Uncheck the 'select all' checkbox after deletion
            $('#selectAll1').prop('checked', false);
        });

        // Select all rows in Tab 2
        $('#selectAll2').on('click', function () {
            var isChecked = $(this).is(':checked');
            $('#example2 .row-select').prop('checked', isChecked);
        });

        // Delete selected rows in Tab 2
        $('#deleteSelected2').on('click', function () {
            var rowsToDelete = [];
            table2.rows().every(function () {
                var $checkbox = $(this.node()).find('.row-select');
                if ($checkbox.is(':checked')) {
                    rowsToDelete.push(this); // Collect rows to delete
                }
            });

            // Remove selected rows
            rowsToDelete.forEach(function (row) {
                row.remove().draw();
            });

            // Uncheck the 'select all' checkbox after deletion
            $('#selectAll2').prop('checked', false);
        });

        // Column visibility toggle for both tabs
        $('.column-toggle-buttons button').on('click', function () {
            var column = $(this).data('column');
            var tableId = $(this).closest('.tab-pane').find('table').attr('id');
            var table = $('#' + tableId).DataTable();
            var columnApi = table.column(column);

            // Toggle column visibility
            columnApi.visible(!columnApi.visible());
        });
    });
</script>

</body>
</html>
